# 基于box2dwed的基站信号仿真模拟
[toc]
>背景
&emsp;&emsp;现实世界中，进行基站信号仿真需要同时考虑发射器与接收器，但本项目主要仿真对象是发射器覆盖能力模拟。因此，需将建筑外立面穿透损耗、空间传输损耗和大气损耗进行综合考虑，而暂时不考虑室内穿透损耗。
---

## 1 外立面材质穿透损耗
测试场景     | 0.9GHz| 1.8GHz| 1.9GHz| 2.6GHz| 3.5GHz| 4.9GHz
-------- | -----| -----| -----| -----| -----| -----
玻璃幕墙  | 9.08| 9.88| 10.72| 12.2| 14.85| 16.58
砖混墙  | 12.91| 15.75| 15.93| 16.6| 22.01| 22.56
室内隔断  | 16.22| 21.22| 21.91| 22.3| 23.05| 24.95
钢混外墙  | 35.31| 43.05| 43.17| 44.1| 48.79| 49.88

&#8195;根据上表可知，**玻璃墙体穿透衰减相对较小**。

## 2 空间传输损耗
&#8194;&#8194;&#8194;&#8194;在气温25℃，1标准大气压下，计算无线电空间传播耗损摔跤，便于网络设计者根据无线链路的裕量大小选择合适类 型的天线（方向，极化，增益等指标），安装天线高度，选择合适的馈缆和长度等。

### 2.1 自由空间损耗计算
自由空间损耗是指电磁波在传输路径中的衰落,其公式如下：
$$ Lbf = 32.4 + 20lgF + 20lgD $$
**式中:**
$ F=频率（MHz） $ 
$ D=距离（km） $ 
**示例:**
2400MHz:$ Lbf = 100 + 20lgD $
5800MHz:$ Lbf = 108 + 20lgD $

---

1）运营商3-5G频段

运营商 | 制式 | 上行频率 | 下行频率| $ lgF$
--------|--------|--------|--------|--------|--------|
移动3G | TD-SCDMA | 2010-2025 | 2010-2025 | 66 
移动4G | TD-LTE | 1880-1890<br>2320-2370<br>2575-2635 | 1880-1890<br>2320-2370<br>2575-2635 | 65<br>67<br>68 
移动5G | 测试 | 4800-4900 | 4800-4900 | 74 
联通3G | WCDMA | 1940-1955 | 2130-2145 | 66 
联通4G | TD-LTE | 2300-2320<br>2555-2575 | 2300-2320<br>2555-2575 | 67<br>68
联通4G | FDD-LTE | 1755-1765 | 1850-1860 | 65
联通5G | 测试 | 3500-3600 | 3500-3600 | 71 
电信3G | CDMA2000 | 1920-1935 | 2110-2125 | 65<br>68 
电信4G | TD-LTE | 2370-2390<br>2635-2655 | 2370-2390<br>2635-2655 | 67<br>68
电信4G | FDD-LTE | 1765-1780 | 1860-1875 | 65
电信5G | 测试 | 3400-3500 | 3400-3500 | 71 

2）基站输出功率及覆盖范围
$ 功率绝对值 = 10lgP (P=功率值/1mw) $

$ 功率 = 10^{(功率绝对值/10)-3} $

基站发射功率40dbm，约为10W，同理40-60W约为46-48dbm

### 2.2 信号接收强度
&#8195;&#8195;信号接收强度是指接收站设备接收到的无线信号的强度。
$$ RSS = Pt+Gr+Gt-Lc-Lbf $$
**式中:**
$ RSS=接收信号强度 $ 
$ Pt=发射功率 $ 
$ Gr=接收天线增益 $ 
$ Gt=发射天线增益 $ 
$ Lc=电缆和缆头的衰耗 $ 
$ Lbf=自由空间损耗 $ 

### 2.3 链路系统裕量
&#8195;&#8195;链路系统裕量是指接收站设备实际接收到的无线信号与接收站设备允许的最低接收阈值（设备接收灵敏度）相比多的富裕dB数值。

$$ SFM = RSS-Rs $$
**式中:**
$ RSS=接收信号强度 $ 
$ Rs=设备接收灵敏度 $ 

&#8195;&#8195;无线信道是一个参变信道，干扰和噪音信号随时会影响有用信号，有时干扰和噪音信号的强度瞬间可达成 20~30dB，所以在建设无线链路时，必须保留一定的系统裕量。虽然系统裕量大于5dB系统可以工作，但通常建议系统裕量大于15-20dB。


## 3 概念说明

单位换算：
$ NdBm = 10^{(N/10)}mW $
$ NdBm = 10^{(N/10)}/1000W $

$ NmW = 10*lg(N)dBm $
$ NW = 10*lg(N/1000)dBm $

加减规则：
dBm+dBm，需要先换算为mW再相加，最终换算为dBm，单位dBm
dBm-dBm，直接加减，单位dB
dBm±dB，直接加减，单位dBm
dB±dB，直接加减，单位dB

RS：参考信号，就是平时所说的导频信号，专用于测量信道的一种信号，与客户业务什么的都没有关系，只用于测量。

CQI：信道质量指标，代表当前信道质量的好坏，和信道的信噪比大小相对应，取值范围0～31，其中0是最差，31是最好，一般都在12~24之间。

SINR：信号与干扰加噪声比，顾名思义就是有效信号/（噪声+干扰），可以简单地理解为我们所熟悉的信噪比。

RSRP：参考信号接收功率，用于LTE网络中可以代表信号的强度，用处和规范都等同于WCDMA网络中的RSCP。由于RSRP是一个对数值（负值），这个值越小代表信号越差，越大代表信号越强。

RSSI：接收的信号强度指示，表示基站侧接收到的所有信号的强度，包括有效信号、噪声和干扰。

## 4 射线投射及能量守恒

&#8195;&#8195;在对室外点波传播路径进行射线投射模拟时，只考虑电波的直射、反射和绕射，透射进入建筑物内部的部分，则考虑为不再穿透建筑物到达室外，既不考虑折射。从发射点辐射出的射线，很多都会经过多次反射和绕射或者是它们的组合，因此到达的射线路径包括了直射、反射、绕射的混合路径。接收点的场强计算是将到达的各种射线，场强进行叠加。

**直射场：**
$$ 直射场强(E_{p},dBm) = 发射功率(Tx,dBm)+天线增益(G,dBi)-空间损耗(L,dB) $$

**反射场：**

反射射线的方向矢量：
$$ r'=r-2(r·n)·n $$

入射面的垂直单位法向矢量
$$ \hat{n}_⊥=n\times r $$
入射面的水平单位法向矢量
$$ \hat{n}_∥=\hat{n}_⊥\times r $$

入射垂直极化分量：电场垂直于入射平面的波为垂直极化波
$$ E_{i⊥} = (E_{i}·\hat{n}_⊥)\hat{n}_{⊥} $$

入射水平极化分量：电场平行于入射平面的波为垂直极化波
$$ E_{i∥} = (E_{i}·\hat{n}_{∥})\hat{n}_{∥} $$

电场垂直极化参数
$$ \Gamma_{⊥} = \frac{\cos\theta-\sqrt{\varepsilon-1+\cos^2\theta}}{\cos\theta+\sqrt{\varepsilon-1+\cos^2\theta}} $$

电场水平极化参数
$$ \Gamma_{∥} = \frac{\varepsilon·\cos\theta-\sqrt{\varepsilon-1+\cos^2\theta}}{\varepsilon·\cos\theta+\sqrt{\varepsilon-1+\cos^2\theta}} $$

反射垂直极化分量
$$ \hat{n}_{r⊥}=\hat{n}_⊥=n\times r $$

反射水平极化分量
$$ \hat{n}_{r∥}=\hat{n}_⊥\times r' $$

反射垂直极化电场
$$ E_{r⊥} = E_{i⊥}\Gamma_{⊥} $$

反射水平极化电场
$$ E_{r∥} = E_{i∥}\Gamma_{∥} $$

反射电场
$$ E_{r} = E_{r⊥}+E_{r∥} $$


**绕射场：**


## 5 无线通信电波传播模型

### 5.1 OKumura-Hata模型
**模型适用范围：**

频率$f$：150～1500MHz | 宏蜂窝
距离$d$：1～35km
基站天线高度$h_t$：30～200m
接收天线高度$h_t$：1～10m

$$ L_b(dB)=69.55+26.16lgf-13.82lgh_t-\alpha(h_r)+(44.9-6.55lgh_t)lgd+C_{cell}+C_{terrain} $$

有效天线修正因子$\alpha(h_r)$
小区类型校正因子$C_{cell}$
地形校正因子$C_{terrain}$

$$ \alpha(h_r) =
  \begin{cases}
    8.29[lg(1.54h_r)]^2-1.1 & \quad \text{大城市}, f≤300MHz\\
    3.2[lg(11.754h_r)]^2-4.97 & \quad \text{大城市}, f≥300MHz\\
    (1.11lgf-0.7)h_r-(1.56lgf-0.8) & \quad \text{中小城市}
  \end{cases}
$$

$$ C_{cell} =
  \begin{cases}
    0 & \quad \text{城市}\\
    -2[lg(f/28)]^2-5.4 & \quad \text{郊区}\\
    -4.78(lgf)^2+18.33lgf-40.94 & \quad \text{乡村}
  \end{cases}
$$

### 5.2 COST-231模型
**模型适用范围：**

频率$f$：800～2000MHz | GSM900/1800 | 微蜂窝
距离$d$：1～35km
基站天线高度$h_t$：30～200m
接收天线高度$h_t$：1～10m

**(1) 可视传播路径损耗**
$$ L_b=42.6+20lgf+26lgd $$

**(2) 非可视传播路径损耗**

*建筑缺省数据*
沿传播路径建筑物间距离$b$：20～50m
道路宽度$w$：$b/2$
建筑物高度$h_{roof}$：$3\times(楼层数)+3斜顶$
相对于直达无线电路径道路方位角$\varphi$：90°


$$ L_b =L_0+L_{rts}+L_{msd} $$

**自由空间传播损耗：**
$$ L_0(dB)=32.4+20lgf(MHz)+20lgd(km) $$

**屋顶至街道的绕射或散射损耗：**
$$ L_{rts}=
  \begin{cases}
    -16.9-10lgw+10lgf+20lgΔh_m+L_{ori}  & \quad h_{roof}>h_m\\
    0  & \quad L_{rts}>0
  \end{cases}
$$

$ L_{ori}=
  \begin{cases}
    -10+0.354\varphi  & \quad 0°≤\varphi<35°\\
    2.5+0.075(\varphi-35)  & \quad 35°≤\varphi<55°\\
    4.0-0.114(\varphi-55)  & \quad 55°≤\varphi<90°
  \end{cases}
$

**多重屏障的绕射损耗：**
$$ L_{msd} =
  \begin{cases}
    L_{bsh}+K_α+K_dlgd+K_flgf-9lgb\\
    0  & \quad L_{msd}<0
  \end{cases}
$$

$ L_{bsh} =
  \begin{cases}
    -18lg(1+Δh_b) & \quad h_b>h_{roof}\\
    0  & \quad h_b≤h_{roof}
  \end{cases}
$

$$ K_α =
  \begin{cases}
    54 & \quad h_b>h_{roof}\\
    54-0.8\timesΔh_b  & \quad h_b≤h_{roof}\text{且}d≥0.5km\\
    54-0.8\timesΔh_b\times \frac{d}{0.5}  & \quad h_b≤h_{roof}\text{且}d≥0.5km
  \end{cases}
$$

$ K_d =
  \begin{cases}
    18 & \quad h_b>h_{roof}\\
    18-5\times\frac{Δh_b}{h_{roof}}  & \quad h_b≤h_{roof}
  \end{cases}
$

$ K_f =
  \begin{cases}
    -4+0.7(\frac{f}{925}-1) & \quad \text{中等城市或郊区}\\
    -4+1.5(\frac{f}{925}-1)  & \quad \text{大城市中心}
  \end{cases}
$

**（3）f=1800GHz传输损耗：**
$ L_{1800}=L_{900}+10dB $

### 5.3 COST231-Hata模型
**模型适用范围：**

频率$f$：1500～2000MHz | GSM900/1800 | 宏蜂窝/微蜂窝（须有详细街道和建筑物数据）
距离$d$：1～20km
基站天线高度$h_t$：30～200m
接收天线高度$h_r$：1～10m

$$ L_b =46.3+33.9lgf-13.82lgh_t+(44.9-6.55lgh_t)lgd-α(h_r)+C_{cell}+C_{terrain}+C_m $$

有效天线修正因子$\alpha(h_r)$
小区类型校正因子$C_{cell}$
地形校正因子$C_{terrain}$
大城市中心校正因子$C_m$

$ C_m =
  \begin{cases}
    3 dB & \quad \text{大城市}\\
    0  dB& \quad \text{中小城市}\\
    -12.28 dB & \quad \text{郊区}
  \end{cases}
$

### 5.4 边缘场强

**定义：** 不同覆盖源之间的边界信号强度，最低电平可用以下公式进行评估：

$$ 边缘场强(Rx,dBm)≥发射功率(Tx,dBm)+天线增益(G,dBi)-路径损耗(L,dB)-人体损耗(Rs,dB)-车体损耗(Cs,dB) $$